import{D as t}from"./p-063edcd0.js";import{S as a}from"./p-7e2c0687.js";import{a as r}from"./p-aa8712f2.js";import{a as e}from"./p-45352c6b.js";import{p as n,g as s}from"./p-e2758593.js";import{g as l}from"./p-89fc07b9.js";const o=t=>(a,r)=>null==a.point&&null==r.point?0:null==a.point?-1:null==r.point?1:t(a.point)===t(r.point)?0:t(r.point)>t(a.point)?1:-1,u=(a,r,e,s)=>{const l=n.left(a,r),o=a[l-1],u=a[l];if(o&&o.x===r.getTime())return o;if(u&&u.x===r.getTime())return u;if(e===t.RIGHT){if(!u)return;return null==s||u.x-r.getTime()<=s?u:void 0}if(e===t.LEFT){if(!o)return;return null==s||r.getTime()-o.x<=s?o:void 0}return o&&u?u:o||u},d=({viewport:t,dataStreams:a,selectedDate:r,allowMultipleDates:e,dataAlignment:n,maxDurationFromDate:d})=>{const i=a.map(a=>({streamId:a.id,dataPoints:s(l(a,a.resolution),t.end)})),m=r.getTime(),p=i.map(({streamId:t,dataPoints:a})=>({streamId:t,point:u(a,r,n,d)}));if(e)return p;const f=p.sort(o(t=>Math.abs(t.x-m)));if(0===f.length)return[];const c=f[f.length-1].point;return null==c?f:f.filter(t=>t.point&&t.point.x===c.x)},i=(t,a)=>null==t?a:null==t.severity&&null==a.severity?t:null==t.severity?a:null==a.severity||t.severity<=a.severity?t:a,m=(t,a)=>{const{dataStreamIds:r}=t;return null==r||r.includes(a)},p=({value:n,date:s,thresholds:l,dataStreams:o,dataStream:d})=>{const p=l.filter(t=>m(t,d.id));return(t=>t.reduce(i,void 0))([null!=n?r(n,p):void 0,...(({date:n,dataStream:s,dataStreams:l,thresholds:o})=>{const d=null!=s.associatedStreams?s.associatedStreams.filter(({type:t})=>t===a.ALARM).map(({id:t})=>t):[];return l.filter(t=>d.includes(t.id)).map(a=>{const e=o.filter(t=>m(t,a.id)),s=u(a.data,n,t.LEFT);return null!=s?r(s.y,e):void 0}).filter(e)})({date:s,dataStream:d,dataStreams:o,thresholds:l})].filter(e))};export{d as a,p as b,u as c,o as s}