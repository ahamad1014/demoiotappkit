import{r as t,h as e}from"./p-0e8c62cb.js";import{a2 as i}from"./p-9b4ace9d.js";import"./p-a6d4a8b1.js";const s=(t,e,i)=>{e.forEach((e=>{t.push(Object.assign(Object.assign({},e.asset),{hasChildren:e.hierarchies.size>0,parentId:i})),e.hierarchies.forEach((i=>{s(t,i.children,e.asset.id)}))}))};let n;const o=new Uint8Array(16);function r(){if(!n&&(n="undefined"!=typeof crypto&&crypto.getRandomValues&&crypto.getRandomValues.bind(crypto),!n))throw new Error("crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported");return n(o)}const a=[];for(let t=0;t<256;++t)a.push((t+256).toString(16).slice(1));const h={randomUUID:"undefined"!=typeof crypto&&crypto.randomUUID&&crypto.randomUUID.bind(crypto)};function l(t,e,i){if(h.randomUUID&&!e&&!t)return h.randomUUID();const s=(t=t||{}).random||(t.rng||r)();if(s[6]=15&s[6]|64,s[8]=63&s[8]|128,e){i=i||0;for(let t=0;t<16;++t)e[i+t]=s[t];return e}return function(t,e=0){return(a[t[e+0]]+a[t[e+1]]+a[t[e+2]]+a[t[e+3]]+"-"+a[t[e+4]]+a[t[e+5]]+"-"+a[t[e+6]]+a[t[e+7]]+"-"+a[t[e+8]]+a[t[e+9]]+"-"+a[t[e+10]]+a[t[e+11]]+a[t[e+12]]+a[t[e+13]]+a[t[e+14]]+a[t[e+15]]).toLowerCase()}(s)}const d=[{sortingField:"name",id:"name",header:"Asset Name",cell:({name:t})=>t},{sortingField:"status",id:"status",header:"Status",cell:({status:t})=>null==t?void 0:t.state},{sortingField:"creationDate",id:"creationDate",header:"Created",cell:({creationDate:t})=>null==t?void 0:t.toUTCString()},{sortingField:"lastUpdateDate",id:"lastUpdateDate",header:"Updated",cell:({lastUpdateDate:t})=>null==t?void 0:t.toUTCString()}],c=class{constructor(e){t(this,e),this.columnDefinitions=d,this.filterEnabled=!0,this.sortingEnabled=!0,this.paginationEnabled=!0,this.wrapLines=!1,this.widgetId=l(),this.expanded=!1,this.items=[],this.expandedItems={},this.errors=[],this.defaults={selectionType:"single",loadingText:"loading...",filterText:{placeholder:"Filter by name",empty:"No assets found.",noMatch:"We can't find a match."},empty:{header:"No assets",description:"You don't have any asset."}},this.expandNode=t=>{var e;null===(e=t.hierarchies)||void 0===e||e.forEach((e=>{this.provider.expand(new i(t.id,e.id))}))}}buildProvider(){return this.query.build(this.widgetId)}componentWillLoad(){this.provider=this.buildProvider(),this.provider.subscribe({next:t=>{this.items=(t=>{const e=[];return s(e,t),e})(t)},error:t=>{this.errors=t}})}componentWillUnmount(){this.provider.unsubscribe()}watchItems(t){if(this.expanded){const e={};t.forEach((({id:t,hierarchies:s,hasChildren:n})=>{!this.expandedItems[t]&&n&&(null==s||s.forEach((e=>{this.provider.expand(new i(t,e.id))})),e[t]=!0)})),this.expandedItems=Object.assign(Object.assign({},this.expandedItems),e)}}render(){var t;const i=this.filterEnabled?this.filterTexts||this.defaults.filterText:void 0,s={columnDefinitions:this.columnDefinitions,keyPropertyName:"id",parentKeyPropertyName:"parentId",selection:{keepSelection:!0},sorting:{defaultState:{sortingColumn:{sortingField:"name"},isDescending:!0}},filtering:i};this.paginationEnabled&&(s.pagination={pageSize:20});let n=this.defaults.empty;return this.empty&&(n=this.empty),this.errors.length>0&&(n={header:"Error",description:null===(t=this.errors[this.errors.length-1])||void 0===t?void 0:t.msg}),e("iot-tree-table",{items:this.items,collectionOptions:s,columnDefinitions:this.columnDefinitions,selectionType:this.selectionType||this.defaults.selectionType,loadingText:this.loadingText||this.defaults.loadingText,filterPlaceholder:null==i?void 0:i.placeholder,onExpandChildren:this.expandNode,onSelectionChange:this.onSelectionChange,empty:n,sortingDisabled:!this.sortingEnabled,wrapLines:this.wrapLines,expanded:this.expanded})}static get watchers(){return{items:["watchItems"]}}};export{c as iot_resource_explorer}